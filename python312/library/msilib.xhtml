<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" xmlns:epub="http://www.idpf.org/2007/ops">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />
<meta property="og:title" content="msilib --- 读写 Microsoft Installer 文件" />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://docs.python.org/3/library/msilib.xhtml" />
<meta property="og:site_name" content="Python documentation" />
<meta property="og:description" content="源代码: Lib/msilib/__init__.py[https://github.com/python/cpython/tree/3.12/Lib/msilib/__init__.py] msilib 支持创建 Microsoft 安装程序 (.msi) 文件。 由于这种文件往往包含一个嵌入的 &quot;cabinet&quot; 文件 (.cab)，它也暴露了一个用于创建 CAB 文件的 API。 目前..." />
<meta property="og:image" content="https://docs.python.org/3/_static/og-image.png" />
<meta property="og:image:alt" content="Python documentation" />
<meta name="description" content="源代码: Lib/msilib/__init__.py[https://github.com/python/cpython/tree/3.12/Lib/msilib/__init__.py] msilib 支持创建 Microsoft 安装程序 (.msi) 文件。 由于这种文件往往包含一个嵌入的 &quot;cabinet&quot; 文件 (.cab)，它也暴露了一个用于创建 CAB 文件的 API。 目前..." />
<meta property="og:image:width" content="200" />
<meta property="og:image:height" content="200" />
<meta name="theme-color" content="#3776ab" />

    <title>msilib --- 读写 Microsoft Installer 文件</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/epub.css" />
    <link rel="canonical" href="https://docs.python.org/3/library/msilib.html" />
    
      
    

    
    <style>
      @media only screen {
        table.full-width-table {
            width: 100%;
        }
      }
    </style>
 

  </head><body>


    <div class="document">
      <div class="documentwrapper">
          <div class="body" role="main">
            
  <section id="module-msilib">
<span id="msilib-read-and-write-microsoft-installer-files"></span><h1><a class="reference internal" href="#module-msilib" title="msilib: Creation of Microsoft Installer files, and CAB files.（已弃用） (Windows)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">msilib</span></code></a> --- 读写 Microsoft Installer 文件</h1>
<p><strong>源代码:</strong> <a class="reference external" href="https://github.com/python/cpython/tree/3.12/Lib/msilib/__init__.py">Lib/msilib/__init__.py</a><span class="link-target"> [https://github.com/python/cpython/tree/3.12/Lib/msilib/__init__.py]</span></p>
<div class="deprecated-removed" id="index-0">
<p><span class="versionmodified">从 3.11 版起不建议使用，将在 3.13 版中移除: </span><a class="reference internal" href="#module-msilib" title="msilib: Creation of Microsoft Installer files, and CAB files.（已弃用） (Windows)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">msilib</span></code></a> 模块已被弃用（请参阅 <span class="target" id="index-3"></span><a class="pep reference external" href="https://peps.python.org/pep-0594/#msilib"><strong>PEP 594</strong></a><span class="link-target"> [https://peps.python.org/pep-0594/#msilib]</span> 了解详情）。</p>
</div>
<hr class="docutils" />
<p><a class="reference internal" href="#module-msilib" title="msilib: Creation of Microsoft Installer files, and CAB files.（已弃用） (Windows)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">msilib</span></code></a> 支持创建 Microsoft 安装程序 (<code class="docutils literal notranslate"><span class="pre">.msi</span></code>) 文件。 由于这种文件往往包含一个嵌入的 &quot;cabinet&quot; 文件 (<code class="docutils literal notranslate"><span class="pre">.cab</span></code>)，它也暴露了一个用于创建 CAB 文件的 API。  目前没有实现对读取 <code class="docutils literal notranslate"><span class="pre">.cab</span></code> 文件的支持；对于读取 <code class="docutils literal notranslate"><span class="pre">.msi</span></code> 数据库的支持则是可能的。</p>
<p>这个包的目标是提供对 <code class="docutils literal notranslate"><span class="pre">.msi</span></code> 文件中的全部表的完整访问，因此，它是一个相当低层级的 API。 这个包的一个主要应用是创建 Python 安装程序包本身 (尽管它目前是使用不同版本的 <code class="docutils literal notranslate"><span class="pre">msilib</span></code>)。</p>
<p>这个包的内容可以大致分为四个部分：低层级 CAB 例程、低层级 MSI 例程、高层级 MSI 例程以及标准表结构。</p>
<dl class="py function">
<dt class="sig sig-object py" id="msilib.FCICreate">
<span class="sig-prename descclassname"><span class="pre">msilib.</span></span><span class="sig-name descname"><span class="pre">FCICreate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cabname</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">files</span></span></em><span class="sig-paren">)</span></dt>
<dd><p>新建一个名为 <em>cabname</em> 的 CAB 文件。 <em>files</em> 必须是一个元组的列表，其中每个元组包含磁盘文件的名称，以及 CAB 文件内文件的名称。</p>
<p>这些文件将按照它们在列表中出现的顺序被添加到 CAB 文件中。 所有文件都会被添加到单个 CAB 文件，使用 MSZIP 压缩算法。</p>
<p>目前没有暴露 MSI 创建的各个步骤对 Python 的回调。</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="msilib.UuidCreate">
<span class="sig-prename descclassname"><span class="pre">msilib.</span></span><span class="sig-name descname"><span class="pre">UuidCreate</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span></dt>
<dd><p>返回一个新的唯一标识符的字符串表示形式。 这封装了 Windows API 函数 <code class="xref c c-func docutils literal notranslate"><span class="pre">UuidCreate()</span></code> 和 <code class="xref c c-func docutils literal notranslate"><span class="pre">UuidToString()</span></code>。</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="msilib.OpenDatabase">
<span class="sig-prename descclassname"><span class="pre">msilib.</span></span><span class="sig-name descname"><span class="pre">OpenDatabase</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">persist</span></span></em><span class="sig-paren">)</span></dt>
<dd><p>通过调用 MsiOpenDatabase 来返回一个新的数据库对象。 <em>path</em> 为 MSI 文件的名称；<em>persist</em> 可以是常量 <code class="docutils literal notranslate"><span class="pre">MSIDBOPEN_CREATEDIRECT</span></code>, <code class="docutils literal notranslate"><span class="pre">MSIDBOPEN_CREATE</span></code>, <code class="docutils literal notranslate"><span class="pre">MSIDBOPEN_DIRECT</span></code>, <code class="docutils literal notranslate"><span class="pre">MSIDBOPEN_READONLY</span></code> 或 <code class="docutils literal notranslate"><span class="pre">MSIDBOPEN_TRANSACT</span></code> 中的一个，并可能包括旗标 <code class="docutils literal notranslate"><span class="pre">MSIDBOPEN_PATCHFILE</span></code>。 请参阅 Microsoft 文档了解这些旗标的含义；根据这些旗标，将打开一个现有数据库，或者创建一个新数据库。</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="msilib.CreateRecord">
<span class="sig-prename descclassname"><span class="pre">msilib.</span></span><span class="sig-name descname"><span class="pre">CreateRecord</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">count</span></span></em><span class="sig-paren">)</span></dt>
<dd><p>通过调用 <code class="xref c c-func docutils literal notranslate"><span class="pre">MSICreateRecord()</span></code> 来返回一个新的记录对象。 <em>count</em> 为记录的字段数量。</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="msilib.init_database">
<span class="sig-prename descclassname"><span class="pre">msilib.</span></span><span class="sig-name descname"><span class="pre">init_database</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">schema</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ProductName</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ProductCode</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ProductVersion</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Manufacturer</span></span></em><span class="sig-paren">)</span></dt>
<dd><p>创建并返回一个新的数据库 <em>name</em>，使用 <em>schema</em> 来初始化它，并设置属性 <em>ProductName</em>, <em>ProductCode</em>, <em>ProductVersion</em> 和 <em>Manufacturer</em>。</p>
<p><em>schema</em> 必须是一个包含 <code class="docutils literal notranslate"><span class="pre">tables</span></code> 和 <code class="docutils literal notranslate"><span class="pre">_Validation_records</span></code> 属性的模块对象；在通常情况下，<a class="reference internal" href="#msilib.schema" title="msilib.schema"><code class="xref py py-mod docutils literal notranslate"><span class="pre">msilib.schema</span></code></a> 应当被使用。</p>
<p>此此函数返回时该数据库将只包含表结构和验证记录。</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="msilib.add_data">
<span class="sig-prename descclassname"><span class="pre">msilib.</span></span><span class="sig-name descname"><span class="pre">add_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">database</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">table</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">records</span></span></em><span class="sig-paren">)</span></dt>
<dd><p>将所有 <em>records</em> 添加到 <em>database</em> 中名为 <em>table</em> 的表。</p>
<p><em>table</em> 参数必须为 MSI 方案中预定义的表之一，即 <code class="docutils literal notranslate"><span class="pre">'Feature'</span></code>, <code class="docutils literal notranslate"><span class="pre">'File'</span></code>, <code class="docutils literal notranslate"><span class="pre">'Component'</span></code>, <code class="docutils literal notranslate"><span class="pre">'Dialog'</span></code>, <code class="docutils literal notranslate"><span class="pre">'Control'</span></code> 等等。</p>
<p><em>records</em> 应当为一个元组的列表，其中的每个元组都包含与表结构对应的记录的所有字段。 对于可选字段，可以传入 <code class="docutils literal notranslate"><span class="pre">None</span></code>。</p>
<p>字段值可以为整数、字符串或 Binary 类的实例。</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="msilib.Binary">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">msilib.</span></span><span class="sig-name descname"><span class="pre">Binary</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span></dt>
<dd><p>代表 Binary 表中的条目；使用 <a class="reference internal" href="#msilib.add_data" title="msilib.add_data"><code class="xref py py-func docutils literal notranslate"><span class="pre">add_data()</span></code></a> 插入这样的对象会将名为 <em>filename</em> 文件读入表中。</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="msilib.add_tables">
<span class="sig-prename descclassname"><span class="pre">msilib.</span></span><span class="sig-name descname"><span class="pre">add_tables</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">database</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">module</span></span></em><span class="sig-paren">)</span></dt>
<dd><p>将来自 <em>module</em> 的所有表内容添加到 <em>database</em>。 <em>module</em> 必须包括一个列出其内容需要被添加的所有表的属性 <em>tables</em>，并且每个具有实际内容的表对应一个属性。</p>
<p>这通常被用来安装序列表。</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="msilib.add_stream">
<span class="sig-prename descclassname"><span class="pre">msilib.</span></span><span class="sig-name descname"><span class="pre">add_stream</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">database</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">path</span></span></em><span class="sig-paren">)</span></dt>
<dd><p>将文件 <em>path</em> 添加到 <em>database</em> 的 <code class="docutils literal notranslate"><span class="pre">_Stream</span></code> 表，使用流名称 <em>name</em>。</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="msilib.gen_uuid">
<span class="sig-prename descclassname"><span class="pre">msilib.</span></span><span class="sig-name descname"><span class="pre">gen_uuid</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span></dt>
<dd><p>返回一个新的 UUID，符合 MSI 通常的格式要求（即外加花括号，且所有十六进制数码均为大写形式）。</p>
</dd></dl>

<div class="admonition seealso">
<p class="admonition-title">参见</p>
<p><a class="reference external" href="https://msdn.microsoft.com/en-us/library/bb432265.aspx">FCICreate</a><span class="link-target"> [https://msdn.microsoft.com/en-us/library/bb432265.aspx]</span>
<a class="reference external" href="https://msdn.microsoft.com/en-us/library/windows/desktop/aa379205.aspx">UuidCreate</a><span class="link-target"> [https://msdn.microsoft.com/en-us/library/windows/desktop/aa379205.aspx]</span>
<a class="reference external" href="https://msdn.microsoft.com/en-us/library/windows/desktop/aa379352.aspx">UuidToString</a><span class="link-target"> [https://msdn.microsoft.com/en-us/library/windows/desktop/aa379352.aspx]</span></p>
</div>
<section id="database-objects">
<span id="id1"></span><h2>数据对象</h2>
<dl class="py method">
<dt class="sig sig-object py" id="msilib.Database.OpenView">
<span class="sig-prename descclassname"><span class="pre">Database.</span></span><span class="sig-name descname"><span class="pre">OpenView</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sql</span></span></em><span class="sig-paren">)</span></dt>
<dd><p>通过调用 <code class="xref c c-func docutils literal notranslate"><span class="pre">MSIDatabaseOpenView()</span></code> 返回一个视图对象。 <em>sql</em> 是要执行的 SQL 语句。statement to execute.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="msilib.Database.Commit">
<span class="sig-prename descclassname"><span class="pre">Database.</span></span><span class="sig-name descname"><span class="pre">Commit</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span></dt>
<dd><p>通过调用 <code class="xref c c-func docutils literal notranslate"><span class="pre">MSIDatabaseCommit()</span></code> 提交当前事务中挂起的修改。</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="msilib.Database.GetSummaryInformation">
<span class="sig-prename descclassname"><span class="pre">Database.</span></span><span class="sig-name descname"><span class="pre">GetSummaryInformation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">count</span></span></em><span class="sig-paren">)</span></dt>
<dd><p>通过调用 <code class="xref c c-func docutils literal notranslate"><span class="pre">MsiGetSummaryInformation()</span></code> 返回一个新的概要信息对象。 <em>count</em> 为已更新值的最大数量。</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="msilib.Database.Close">
<span class="sig-prename descclassname"><span class="pre">Database.</span></span><span class="sig-name descname"><span class="pre">Close</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span></dt>
<dd><p>通过 <code class="xref c c-func docutils literal notranslate"><span class="pre">MsiCloseHandle()</span></code> 关闭数据库对象。</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 3.7.</span></p>
</div>
</dd></dl>

<div class="admonition seealso">
<p class="admonition-title">参见</p>
<p><a class="reference external" href="https://msdn.microsoft.com/en-us/library/windows/desktop/aa370082.aspx">MSIDatabaseOpenView</a><span class="link-target"> [https://msdn.microsoft.com/en-us/library/windows/desktop/aa370082.aspx]</span>
<a class="reference external" href="https://msdn.microsoft.com/en-us/library/windows/desktop/aa370075.aspx">MSIDatabaseCommit</a><span class="link-target"> [https://msdn.microsoft.com/en-us/library/windows/desktop/aa370075.aspx]</span>
<a class="reference external" href="https://msdn.microsoft.com/en-us/library/windows/desktop/aa370301.aspx">MSIGetSummaryInformation</a><span class="link-target"> [https://msdn.microsoft.com/en-us/library/windows/desktop/aa370301.aspx]</span>
<a class="reference external" href="https://msdn.microsoft.com/en-us/library/windows/desktop/aa370067.aspx">MsiCloseHandle</a><span class="link-target"> [https://msdn.microsoft.com/en-us/library/windows/desktop/aa370067.aspx]</span></p>
</div>
</section>
<section id="view-objects">
<span id="id2"></span><h2>视图对象</h2>
<dl class="py method">
<dt class="sig sig-object py" id="msilib.View.Execute">
<span class="sig-prename descclassname"><span class="pre">View.</span></span><span class="sig-name descname"><span class="pre">Execute</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span></dt>
<dd><p>通过 <code class="xref c c-func docutils literal notranslate"><span class="pre">MSIViewExecute()</span></code> 执行视图的 SQL 查询。 如果 <em>params</em> 不为 <code class="docutils literal notranslate"><span class="pre">None</span></code>，它应是一条描述查询中形参名称的实际值的记录。</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="msilib.View.GetColumnInfo">
<span class="sig-prename descclassname"><span class="pre">View.</span></span><span class="sig-name descname"><span class="pre">GetColumnInfo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kind</span></span></em><span class="sig-paren">)</span></dt>
<dd><p>通过调用 <code class="xref c c-func docutils literal notranslate"><span class="pre">MsiViewGetColumnInfo()</span></code> 返回一条描述视图的列的记录。 <em>kind</em> 可以是 <code class="docutils literal notranslate"><span class="pre">MSICOLINFO_NAMES</span></code> 或 <code class="docutils literal notranslate"><span class="pre">MSICOLINFO_TYPES</span></code>。</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="msilib.View.Fetch">
<span class="sig-prename descclassname"><span class="pre">View.</span></span><span class="sig-name descname"><span class="pre">Fetch</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span></dt>
<dd><p>通过调用 <code class="xref c c-func docutils literal notranslate"><span class="pre">MsiViewFetch()</span></code> 返回查询的结果记录。</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="msilib.View.Modify">
<span class="sig-prename descclassname"><span class="pre">View.</span></span><span class="sig-name descname"><span class="pre">Modify</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kind</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span></dt>
<dd><p>通过调用 <code class="xref c c-func docutils literal notranslate"><span class="pre">MsiViewModify()</span></code> 改变视图。 <em>kind</em> 可以是 <code class="docutils literal notranslate"><span class="pre">MSIMODIFY_SEEK</span></code>，<code class="docutils literal notranslate"><span class="pre">MSIMODIFY_REFRESH</span></code>，<code class="docutils literal notranslate"><span class="pre">MSIMODIFY_INSERT</span></code>，<code class="docutils literal notranslate"><span class="pre">MSIMODIFY_UPDATE</span></code>，<code class="docutils literal notranslate"><span class="pre">MSIMODIFY_ASSIGN</span></code>，<code class="docutils literal notranslate"><span class="pre">MSIMODIFY_REPLACE</span></code>，<code class="docutils literal notranslate"><span class="pre">MSIMODIFY_MERGE</span></code>，<code class="docutils literal notranslate"><span class="pre">MSIMODIFY_DELETE</span></code>，<code class="docutils literal notranslate"><span class="pre">MSIMODIFY_INSERT_TEMPORARY</span></code>，<code class="docutils literal notranslate"><span class="pre">MSIMODIFY_VALIDATE</span></code>，<code class="docutils literal notranslate"><span class="pre">MSIMODIFY_VALIDATE_NEW</span></code>，<code class="docutils literal notranslate"><span class="pre">MSIMODIFY_VALIDATE_FIELD</span></code>，<code class="docutils literal notranslate"><span class="pre">MSIMODIFY_VALIDATE_DELETE</span></code> 中的一种。</p>
<p><em>data</em> 必须是一个描述新数据的记录。</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="msilib.View.Close">
<span class="sig-prename descclassname"><span class="pre">View.</span></span><span class="sig-name descname"><span class="pre">Close</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span></dt>
<dd><p>通过 <code class="xref c c-func docutils literal notranslate"><span class="pre">MsiViewClose()</span></code> 关闭窗口。</p>
</dd></dl>

<div class="admonition seealso">
<p class="admonition-title">参见</p>
<p><a class="reference external" href="https://msdn.microsoft.com/en-us/library/windows/desktop/aa370513.aspx">MsiViewExecute</a><span class="link-target"> [https://msdn.microsoft.com/en-us/library/windows/desktop/aa370513.aspx]</span>
<a class="reference external" href="https://msdn.microsoft.com/en-us/library/windows/desktop/aa370516.aspx">MSIViewGetColumnInfo</a><span class="link-target"> [https://msdn.microsoft.com/en-us/library/windows/desktop/aa370516.aspx]</span>
<a class="reference external" href="https://msdn.microsoft.com/en-us/library/windows/desktop/aa370514.aspx">MsiViewFetch</a><span class="link-target"> [https://msdn.microsoft.com/en-us/library/windows/desktop/aa370514.aspx]</span>
<a class="reference external" href="https://msdn.microsoft.com/en-us/library/windows/desktop/aa370519.aspx">MsiViewModify</a><span class="link-target"> [https://msdn.microsoft.com/en-us/library/windows/desktop/aa370519.aspx]</span>
<a class="reference external" href="https://msdn.microsoft.com/en-us/library/windows/desktop/aa370510.aspx">MsiViewClose</a><span class="link-target"> [https://msdn.microsoft.com/en-us/library/windows/desktop/aa370510.aspx]</span></p>
</div>
</section>
<section id="summary-information-objects">
<span id="summary-objects"></span><h2>对象总览</h2>
<dl class="py method">
<dt class="sig sig-object py" id="msilib.SummaryInformation.GetProperty">
<span class="sig-prename descclassname"><span class="pre">SummaryInformation.</span></span><span class="sig-name descname"><span class="pre">GetProperty</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">field</span></span></em><span class="sig-paren">)</span></dt>
<dd><p>通过 <code class="xref c c-func docutils literal notranslate"><span class="pre">MsiSummaryInfoGetProperty()</span></code> 返回概要的特征属性。 <em>field</em> 是属性的名称，可以是常量 <code class="docutils literal notranslate"><span class="pre">PID_CODEPAGE</span></code>, <code class="docutils literal notranslate"><span class="pre">PID_TITLE</span></code>, <code class="docutils literal notranslate"><span class="pre">PID_SUBJECT</span></code>, <code class="docutils literal notranslate"><span class="pre">PID_AUTHOR</span></code>, <code class="docutils literal notranslate"><span class="pre">PID_KEYWORDS</span></code>, <code class="docutils literal notranslate"><span class="pre">PID_COMMENTS</span></code>, <code class="docutils literal notranslate"><span class="pre">PID_TEMPLATE</span></code>, <code class="docutils literal notranslate"><span class="pre">PID_LASTAUTHOR</span></code>, <code class="docutils literal notranslate"><span class="pre">PID_REVNUMBER</span></code>, <code class="docutils literal notranslate"><span class="pre">PID_LASTPRINTED</span></code>, <code class="docutils literal notranslate"><span class="pre">PID_CREATE_DTM</span></code>, <code class="docutils literal notranslate"><span class="pre">PID_LASTSAVE_DTM</span></code>, <code class="docutils literal notranslate"><span class="pre">PID_PAGECOUNT</span></code>, <code class="docutils literal notranslate"><span class="pre">PID_WORDCOUNT</span></code>, <code class="docutils literal notranslate"><span class="pre">PID_CHARCOUNT</span></code>, <code class="docutils literal notranslate"><span class="pre">PID_APPNAME</span></code> 或 <code class="docutils literal notranslate"><span class="pre">PID_SECURITY</span></code> 中的一个。</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="msilib.SummaryInformation.GetPropertyCount">
<span class="sig-prename descclassname"><span class="pre">SummaryInformation.</span></span><span class="sig-name descname"><span class="pre">GetPropertyCount</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span></dt>
<dd><p>通过 <code class="xref c c-func docutils literal notranslate"><span class="pre">MsiSummaryInfoGetPropertyCount()</span></code> 返回概要特征属性的数量。</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="msilib.SummaryInformation.SetProperty">
<span class="sig-prename descclassname"><span class="pre">SummaryInformation.</span></span><span class="sig-name descname"><span class="pre">SetProperty</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">field</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span></dt>
<dd><p>通过 <code class="xref c c-func docutils literal notranslate"><span class="pre">MsiSummaryInfoSetProperty()</span></code> 设置特征属性。 <em>field</em> 可以有与 <a class="reference internal" href="#msilib.SummaryInformation.GetProperty" title="msilib.SummaryInformation.GetProperty"><code class="xref py py-meth docutils literal notranslate"><span class="pre">GetProperty()</span></code></a> 相同的值。 <em>value</em> 是属性的新值。 可用的值类型有整数和字符串。</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="msilib.SummaryInformation.Persist">
<span class="sig-prename descclassname"><span class="pre">SummaryInformation.</span></span><span class="sig-name descname"><span class="pre">Persist</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span></dt>
<dd><p>使用 <code class="xref c c-func docutils literal notranslate"><span class="pre">MsiSummaryInfoPersist()</span></code> 将已修改的特征属性写入到概要信息流。</p>
</dd></dl>

<div class="admonition seealso">
<p class="admonition-title">参见</p>
<p><a class="reference external" href="https://msdn.microsoft.com/en-us/library/windows/desktop/aa370409.aspx">MsiSummaryInfoGetProperty</a><span class="link-target"> [https://msdn.microsoft.com/en-us/library/windows/desktop/aa370409.aspx]</span>
<a class="reference external" href="https://msdn.microsoft.com/en-us/library/windows/desktop/aa370488.aspx">MsiSummaryInfoGetPropertyCount</a><span class="link-target"> [https://msdn.microsoft.com/en-us/library/windows/desktop/aa370488.aspx]</span>
<a class="reference external" href="https://msdn.microsoft.com/en-us/library/windows/desktop/aa370491.aspx">MsiSummaryInfoSetProperty</a><span class="link-target"> [https://msdn.microsoft.com/en-us/library/windows/desktop/aa370491.aspx]</span>
<a class="reference external" href="https://msdn.microsoft.com/en-us/library/windows/desktop/aa370490.aspx">MsiSummaryInfoPersist</a><span class="link-target"> [https://msdn.microsoft.com/en-us/library/windows/desktop/aa370490.aspx]</span></p>
</div>
</section>
<section id="record-objects">
<span id="id3"></span><h2>记录对象</h2>
<dl class="py method">
<dt class="sig sig-object py" id="msilib.Record.GetFieldCount">
<span class="sig-prename descclassname"><span class="pre">Record.</span></span><span class="sig-name descname"><span class="pre">GetFieldCount</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span></dt>
<dd><p>通过 <code class="xref c c-func docutils literal notranslate"><span class="pre">MsiRecordGetFieldCount()</span></code> 返回记录字段的数量。</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="msilib.Record.GetInteger">
<span class="sig-prename descclassname"><span class="pre">Record.</span></span><span class="sig-name descname"><span class="pre">GetInteger</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">field</span></span></em><span class="sig-paren">)</span></dt>
<dd><p>在可能的情况下将 <em>field</em> 的值以整数形式返回。 <em>field</em> 必须为整数。</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="msilib.Record.GetString">
<span class="sig-prename descclassname"><span class="pre">Record.</span></span><span class="sig-name descname"><span class="pre">GetString</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">field</span></span></em><span class="sig-paren">)</span></dt>
<dd><p>在可能的情况下将 <em>field</em> 的值以字符串形式返回。 <em>field</em> 必须为整数。</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="msilib.Record.SetString">
<span class="sig-prename descclassname"><span class="pre">Record.</span></span><span class="sig-name descname"><span class="pre">SetString</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">field</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span></dt>
<dd><p>通过 <code class="xref c c-func docutils literal notranslate"><span class="pre">MsiRecordSetString()</span></code> 将 <em>field</em> 设为 <em>value</em>。 <em>field</em> 必须是一个整数；<em>value</em> 是一个字符串。</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="msilib.Record.SetStream">
<span class="sig-prename descclassname"><span class="pre">Record.</span></span><span class="sig-name descname"><span class="pre">SetStream</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">field</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span></dt>
<dd><p>通过 <code class="xref c c-func docutils literal notranslate"><span class="pre">MsiRecordSetStream()</span></code> 将 <em>field</em> 设为名为 <em>value</em> 的文件的内容。 <em>field</em> 必须是一个整数；<em>value</em> 是一个字符串。</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="msilib.Record.SetInteger">
<span class="sig-prename descclassname"><span class="pre">Record.</span></span><span class="sig-name descname"><span class="pre">SetInteger</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">field</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span></dt>
<dd><p>通过 <code class="xref c c-func docutils literal notranslate"><span class="pre">MsiRecordSetInteger()</span></code> 将 <em>field</em> 设为 <em>value</em>。 <em>field</em> 和 <em>value</em> 必须为整数。</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="msilib.Record.ClearData">
<span class="sig-prename descclassname"><span class="pre">Record.</span></span><span class="sig-name descname"><span class="pre">ClearData</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span></dt>
<dd><p>通过 <code class="xref c c-func docutils literal notranslate"><span class="pre">MsiRecordClearData()</span></code> 将记录的所有字段设为 0。</p>
</dd></dl>

<div class="admonition seealso">
<p class="admonition-title">参见</p>
<p><a class="reference external" href="https://msdn.microsoft.com/en-us/library/windows/desktop/aa370366.aspx">MsiRecordGetFieldCount</a><span class="link-target"> [https://msdn.microsoft.com/en-us/library/windows/desktop/aa370366.aspx]</span>
<a class="reference external" href="https://msdn.microsoft.com/en-us/library/windows/desktop/aa370373.aspx">MsiRecordSetString</a><span class="link-target"> [https://msdn.microsoft.com/en-us/library/windows/desktop/aa370373.aspx]</span>
<a class="reference external" href="https://msdn.microsoft.com/en-us/library/windows/desktop/aa370372.aspx">MsiRecordSetStream</a><span class="link-target"> [https://msdn.microsoft.com/en-us/library/windows/desktop/aa370372.aspx]</span>
<a class="reference external" href="https://msdn.microsoft.com/en-us/library/windows/desktop/aa370371.aspx">MsiRecordSetInteger</a><span class="link-target"> [https://msdn.microsoft.com/en-us/library/windows/desktop/aa370371.aspx]</span>
<a class="reference external" href="https://msdn.microsoft.com/en-us/library/windows/desktop/aa370364.aspx">MsiRecordClearData</a><span class="link-target"> [https://msdn.microsoft.com/en-us/library/windows/desktop/aa370364.aspx]</span></p>
</div>
</section>
<section id="errors">
<span id="msi-errors"></span><h2>错误</h2>
<p>所有 MSI 函数的包装器都会引发 <code class="xref py py-exc docutils literal notranslate"><span class="pre">MSIError</span></code>；异常内部的字符串将包含更多细节。</p>
</section>
<section id="cab-objects">
<span id="cab"></span><h2>CAB 对象</h2>
<dl class="py class">
<dt class="sig sig-object py" id="msilib.CAB">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">msilib.</span></span><span class="sig-name descname"><span class="pre">CAB</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="sig-paren">)</span></dt>
<dd><p><a class="reference internal" href="#msilib.CAB" title="msilib.CAB"><code class="xref py py-class docutils literal notranslate"><span class="pre">CAB</span></code></a> 类代表一个 CAB 文件。 在 MSI 构建过程中，文件将被同时添加到 <code class="docutils literal notranslate"><span class="pre">Files</span></code> 表，以及 CAB 中。 然后，当所有文件添加完成时，即可写入 CAB 文件，再添加到 MSI 文件中。</p>
<p><em>name</em> 是 MSI 文件中 CAB 文件的名称。</p>
<dl class="py method">
<dt class="sig sig-object py" id="msilib.CAB.append">
<span class="sig-name descname"><span class="pre">append</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">full</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logical</span></span></em><span class="sig-paren">)</span></dt>
<dd><p>将路径名为 <em>full</em> 的文件添加到 CAB 文件中，命名为 <em>logical</em>。 如果已存在名为 <em>logical</em> 的文件，则会创建一个新的文件名。</p>
<p>返回文件在 CAB 文件中的索引，以及文件在 CAB 文件中的新名称。</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="msilib.CAB.commit">
<span class="sig-name descname"><span class="pre">commit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">database</span></span></em><span class="sig-paren">)</span></dt>
<dd><p>生成一个 CAB 文件，以流方式添加到 MSI 文件，将其放入 <code class="docutils literal notranslate"><span class="pre">Media</span></code> 表，并从磁盘移除所生成的文件。</p>
</dd></dl>

</dd></dl>

</section>
<section id="directory-objects">
<span id="msi-directory"></span><h2>目录对象</h2>
<dl class="py class">
<dt class="sig sig-object py" id="msilib.Directory">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">msilib.</span></span><span class="sig-name descname"><span class="pre">Directory</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">database</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cab</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">basedir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">physical</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logical</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">default</span></span></em><span class="optional">[</span>, <em class="sig-param"><span class="n"><span class="pre">componentflags</span></span></em><span class="optional">]</span><span class="sig-paren">)</span></dt>
<dd><p>在目录表中创建一个新目录。 在每个时点上对于该目录都有一个当前组件，它或是通过 <a class="reference internal" href="#msilib.Directory.start_component" title="msilib.Directory.start_component"><code class="xref py py-meth docutils literal notranslate"><span class="pre">start_component()</span></code></a> 显式创建，或是在文件首次被加入时隐式创建。 文件会被加入当前组件，并被加入到 cab 文件中。 要创建一个目录，必须指定一个基准目录对象 (可以为 <code class="docutils literal notranslate"><span class="pre">None</span></code>)，指向物理目录的路径，以及一个逻辑目录名称。 <em>default</em> 指明目录表中的 DefaultDir 槽位。 <em>componentflags</em> 指明新组件所获得的默认旗标。</p>
<dl class="py method">
<dt class="sig sig-object py" id="msilib.Directory.start_component">
<span class="sig-name descname"><span class="pre">start_component</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">component</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flags</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keyfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uuid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span></dt>
<dd><p>向组件表添加一个条目，并将该组件设为此目录的当前组件。 如果未给出组件名称，则将使用目录名称。 如果未给出 <em>feature</em>，则将使用当前特征。 如果未给出 <em>flags</em>，则将使用目录的默认旗标。 如果未给出 <em>keyfile</em>，则组件表中的 KeyPath 将保持为空值。</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="msilib.Directory.add_file">
<span class="sig-name descname"><span class="pre">add_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">src</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">version</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">language</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span></dt>
<dd><p>向目录的当前组件添加一个文件，如果没有当前组件则会新建一个。 在默认情况下，源中的文件名和文件表将保持一致。 如果指定了 <em>src</em> 文件，它将被解读为相对于当前目录。 作为可选项，可以为文件表中的条目指定 <em>version</em> 和 <em>language</em>。</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="msilib.Directory.glob">
<span class="sig-name descname"><span class="pre">glob</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pattern</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exclude</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span></dt>
<dd><p>向当前组件添加一个通过 glob 模式指定的文件列表。 单个文件可以在 <em>exclude</em> 列表中排除。</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="msilib.Directory.remove_pyc">
<span class="sig-name descname"><span class="pre">remove_pyc</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span></dt>
<dd><p>在卸载时移除 <code class="docutils literal notranslate"><span class="pre">.pyc</span></code> 文件。</p>
</dd></dl>

</dd></dl>

<div class="admonition seealso">
<p class="admonition-title">参见</p>
<p><a class="reference external" href="https://msdn.microsoft.com/en-us/library/windows/desktop/aa368295.aspx">Directory Table</a><span class="link-target"> [https://msdn.microsoft.com/en-us/library/windows/desktop/aa368295.aspx]</span>
<a class="reference external" href="https://msdn.microsoft.com/en-us/library/windows/desktop/aa368596.aspx">File Table</a><span class="link-target"> [https://msdn.microsoft.com/en-us/library/windows/desktop/aa368596.aspx]</span>
<a class="reference external" href="https://msdn.microsoft.com/en-us/library/windows/desktop/aa368007.aspx">Component Table</a><span class="link-target"> [https://msdn.microsoft.com/en-us/library/windows/desktop/aa368007.aspx]</span>
<a class="reference external" href="https://msdn.microsoft.com/en-us/library/windows/desktop/aa368579.aspx">FeatureComponents Table</a><span class="link-target"> [https://msdn.microsoft.com/en-us/library/windows/desktop/aa368579.aspx]</span></p>
</div>
</section>
<section id="features">
<span id="id4"></span><h2>相关特性</h2>
<dl class="py class">
<dt class="sig sig-object py" id="msilib.Feature">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">msilib.</span></span><span class="sig-name descname"><span class="pre">Feature</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">db</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">desc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">display</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">directory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attributes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span></dt>
<dd><p>使用值 <em>id</em>, <em>parent.id</em>, <em>title</em>, <em>desc</em>, <em>display</em>, <em>level</em>, <em>directory</em> 和 <em>attributes</em> 向 <code class="docutils literal notranslate"><span class="pre">Feature</span></code> 表添加一条新记录。 结果特征对象可被传给 <a class="reference internal" href="#msilib.Directory" title="msilib.Directory"><code class="xref py py-class docutils literal notranslate"><span class="pre">Directory</span></code></a> 的 <code class="xref py py-meth docutils literal notranslate"><span class="pre">start_component()</span></code> 方法。</p>
<dl class="py method">
<dt class="sig sig-object py" id="msilib.Feature.set_current">
<span class="sig-name descname"><span class="pre">set_current</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span></dt>
<dd><p>将此特征设为 <a class="reference internal" href="#module-msilib" title="msilib: Creation of Microsoft Installer files, and CAB files.（已弃用） (Windows)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">msilib</span></code></a> 的当前特征。 新组件会自动被添加到默认特征，除非显式指定了一个特征。</p>
</dd></dl>

</dd></dl>

<div class="admonition seealso">
<p class="admonition-title">参见</p>
<p><a class="reference external" href="https://msdn.microsoft.com/en-us/library/windows/desktop/aa368585.aspx">特征表</a><span class="link-target"> [https://msdn.microsoft.com/en-us/library/windows/desktop/aa368585.aspx]</span></p>
</div>
</section>
<section id="gui-classes">
<span id="msi-gui"></span><h2>GUI 类</h2>
<p><a class="reference internal" href="#module-msilib" title="msilib: Creation of Microsoft Installer files, and CAB files.（已弃用） (Windows)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">msilib</span></code></a> 提供了一些在 MSI 数据库中包装 GUI 表的类。 但是，并未提供标准用户接口。</p>
<dl class="py class">
<dt class="sig sig-object py" id="msilib.Control">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">msilib.</span></span><span class="sig-name descname"><span class="pre">Control</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dlg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="sig-paren">)</span></dt>
<dd><p>对话框控件的基类。 <em>dlg</em> 是控件所属的对话框对象，<em>name</em> 是控件的名称。</p>
<dl class="py method">
<dt class="sig sig-object py" id="msilib.Control.event">
<span class="sig-name descname"><span class="pre">event</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">event</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">argument</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">condition</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ordering</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span></dt>
<dd><p>在 <code class="docutils literal notranslate"><span class="pre">ControlEvent</span></code> 表中为该控件创建一个条目。</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="msilib.Control.mapping">
<span class="sig-name descname"><span class="pre">mapping</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">event</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attribute</span></span></em><span class="sig-paren">)</span></dt>
<dd><p>在 <code class="docutils literal notranslate"><span class="pre">EventMapping</span></code> 表中为该控件创建一个条目。</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="msilib.Control.condition">
<span class="sig-name descname"><span class="pre">condition</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">action</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">condition</span></span></em><span class="sig-paren">)</span></dt>
<dd><p>在 <code class="docutils literal notranslate"><span class="pre">ControlCondition</span></code> 表中为该控件创建一个条目。</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="msilib.RadioButtonGroup">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">msilib.</span></span><span class="sig-name descname"><span class="pre">RadioButtonGroup</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dlg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">property</span></span></em><span class="sig-paren">)</span></dt>
<dd><p>创建一个名为 <em>name</em> 的单选钮控件。 <em>property</em> 是当单选钮被选中时设置的安装器属性。</p>
<dl class="py method">
<dt class="sig sig-object py" id="msilib.RadioButtonGroup.add">
<span class="sig-name descname"><span class="pre">add</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">height</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">text</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span></dt>
<dd><p>向分组添加一个名为 <em>name</em> 的单选钮，设置坐标为 <em>x</em>, <em>y</em>, <em>width</em>, <em>height</em>，标签为 <em>text</em>。 如果 <em>value</em> 为 <code class="docutils literal notranslate"><span class="pre">None</span></code>，则设置默认值 <em>name</em>。</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="msilib.Dialog">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">msilib.</span></span><span class="sig-name descname"><span class="pre">Dialog</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">db</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">default</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cancel</span></span></em><span class="sig-paren">)</span></dt>
<dd><p>返回一个新的 <a class="reference internal" href="#msilib.Dialog" title="msilib.Dialog"><code class="xref py py-class docutils literal notranslate"><span class="pre">Dialog</span></code></a> 对象。 将在 <code class="docutils literal notranslate"><span class="pre">Dialog</span></code> 表中创建一个条目，设置指定的坐标，对话框属性，标题，首个、默认和取消控件的名称。</p>
<dl class="py method">
<dt class="sig sig-object py" id="msilib.Dialog.control">
<span class="sig-name descname"><span class="pre">control</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">height</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attributes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">property</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">text</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">control_next</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">help</span></span></em><span class="sig-paren">)</span></dt>
<dd><p>返回一个新的 <a class="reference internal" href="#msilib.Control" title="msilib.Control"><code class="xref py py-class docutils literal notranslate"><span class="pre">Control</span></code></a> 对象。 将在 <code class="docutils literal notranslate"><span class="pre">Control</span></code> 表中创建带有指定形参的条目。</p>
<p>这是一个通用方法；对于特定的类型，还提供了专用的方法。</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="msilib.Dialog.text">
<span class="sig-name descname"><span class="pre">text</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">height</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attributes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">text</span></span></em><span class="sig-paren">)</span></dt>
<dd><p>添加并返回一个 <code class="docutils literal notranslate"><span class="pre">Text</span></code> 控件。</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="msilib.Dialog.bitmap">
<span class="sig-name descname"><span class="pre">bitmap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">height</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">text</span></span></em><span class="sig-paren">)</span></dt>
<dd><p>添加并返回一个 <code class="docutils literal notranslate"><span class="pre">Bitmap</span></code> 控件。</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="msilib.Dialog.line">
<span class="sig-name descname"><span class="pre">line</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">height</span></span></em><span class="sig-paren">)</span></dt>
<dd><p>添加并返回一个 <code class="docutils literal notranslate"><span class="pre">Line</span></code> 控件。</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="msilib.Dialog.pushbutton">
<span class="sig-name descname"><span class="pre">pushbutton</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">height</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attributes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">text</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">next_control</span></span></em><span class="sig-paren">)</span></dt>
<dd><p>添加并返回一个 <code class="docutils literal notranslate"><span class="pre">PushButton</span></code> 控件。</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="msilib.Dialog.radiogroup">
<span class="sig-name descname"><span class="pre">radiogroup</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">height</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attributes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">property</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">text</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">next_control</span></span></em><span class="sig-paren">)</span></dt>
<dd><p>添加并返回一个 <code class="docutils literal notranslate"><span class="pre">RadioButtonGroup</span></code> 控件。</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="msilib.Dialog.checkbox">
<span class="sig-name descname"><span class="pre">checkbox</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">height</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attributes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">property</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">text</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">next_control</span></span></em><span class="sig-paren">)</span></dt>
<dd><p>添加并返回一个 <code class="docutils literal notranslate"><span class="pre">CheckBox</span></code> 控件。</p>
</dd></dl>

</dd></dl>

<div class="admonition seealso">
<p class="admonition-title">参见</p>
<p><a class="reference external" href="https://msdn.microsoft.com/en-us/library/windows/desktop/aa368286.aspx">Dialog Table</a><span class="link-target"> [https://msdn.microsoft.com/en-us/library/windows/desktop/aa368286.aspx]</span>
<a class="reference external" href="https://msdn.microsoft.com/en-us/library/windows/desktop/aa368044.aspx">Control Table</a><span class="link-target"> [https://msdn.microsoft.com/en-us/library/windows/desktop/aa368044.aspx]</span>
<a class="reference external" href="https://msdn.microsoft.com/en-us/library/windows/desktop/aa368039.aspx">Control Types</a><span class="link-target"> [https://msdn.microsoft.com/en-us/library/windows/desktop/aa368039.aspx]</span>
<a class="reference external" href="https://msdn.microsoft.com/en-us/library/windows/desktop/aa368035.aspx">ControlCondition Table</a><span class="link-target"> [https://msdn.microsoft.com/en-us/library/windows/desktop/aa368035.aspx]</span>
<a class="reference external" href="https://msdn.microsoft.com/en-us/library/windows/desktop/aa368037.aspx">ControlEvent Table</a><span class="link-target"> [https://msdn.microsoft.com/en-us/library/windows/desktop/aa368037.aspx]</span>
<a class="reference external" href="https://msdn.microsoft.com/en-us/library/windows/desktop/aa368559.aspx">EventMapping Table</a><span class="link-target"> [https://msdn.microsoft.com/en-us/library/windows/desktop/aa368559.aspx]</span>
<a class="reference external" href="https://msdn.microsoft.com/en-us/library/windows/desktop/aa370962.aspx">RadioButton Table</a><span class="link-target"> [https://msdn.microsoft.com/en-us/library/windows/desktop/aa370962.aspx]</span></p>
</div>
</section>
<section id="precomputed-tables">
<span id="msi-tables"></span><h2>预计算的表</h2>
<p><a class="reference internal" href="#module-msilib" title="msilib: Creation of Microsoft Installer files, and CAB files.（已弃用） (Windows)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">msilib</span></code></a> 提供了一些仅包含结构模式和表定义的子包。 这些定义基于 MSI 2.0 版。</p>
<dl class="py data">
<dt class="sig sig-object py" id="msilib.schema">
<span class="sig-prename descclassname"><span class="pre">msilib.</span></span><span class="sig-name descname"><span class="pre">schema</span></span></dt>
<dd><p>这是基于 MSI 2.0 的标准 MSI 结构模式，其中 <em>tables</em> 变量提供了一个由表定义组成的列表，而 <em>_Validation_records</em> 提供了用于 MSI 验证的数据。</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="msilib.sequence">
<span class="sig-prename descclassname"><span class="pre">msilib.</span></span><span class="sig-name descname"><span class="pre">sequence</span></span></dt>
<dd><p>此模块包含针对标准序列表的表内容: <em>AdminExecuteSequence</em>, <em>AdminUISequence</em>, <em>AdvtExecuteSequence</em>, <em>InstallExecuteSequence</em> 和 <em>InstallUISequence</em>。</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="msilib.text">
<span class="sig-prename descclassname"><span class="pre">msilib.</span></span><span class="sig-name descname"><span class="pre">text</span></span></dt>
<dd><p>此模块包含 UIText 和 ActionText 表的定义，用于标准安装器动作。</p>
</dd></dl>

</section>
</section>


            <div class="clearer"></div>
          </div>
      </div>
      <div class="clearer"></div>
    </div>
  </body>
</html>