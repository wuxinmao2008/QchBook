<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" xmlns:epub="http://www.idpf.org/2007/ops">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />
<meta property="og:title" content="http.server --- HTTP 服务器" />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://docs.python.org/3/library/http.server.xhtml" />
<meta property="og:site_name" content="Python documentation" />
<meta property="og:description" content="源代码： Lib/http/server.py[https://github.com/python/cpython/tree/3.12/Lib/http/server.py] 这个模块定义了用于实现 HTTP 服务器的类。 可用性: 非 Emscripten，非 WASI。 此模块在 WebAssembly 平台 wasm32-emscripten 和 wasm32-wasi 上不适用或不可..." />
<meta property="og:image" content="https://docs.python.org/3/_static/og-image.png" />
<meta property="og:image:alt" content="Python documentation" />
<meta name="description" content="源代码： Lib/http/server.py[https://github.com/python/cpython/tree/3.12/Lib/http/server.py] 这个模块定义了用于实现 HTTP 服务器的类。 可用性: 非 Emscripten，非 WASI。 此模块在 WebAssembly 平台 wasm32-emscripten 和 wasm32-wasi 上不适用或不可..." />
<meta property="og:image:width" content="200" />
<meta property="og:image:height" content="200" />
<meta name="theme-color" content="#3776ab" />

    <title>http.server --- HTTP 服务器</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/epub.css" />
    <link rel="canonical" href="https://docs.python.org/3/library/http.server.html" />
    
      
    

    
    <style>
      @media only screen {
        table.full-width-table {
            width: 100%;
        }
      }
    </style>
 

  </head><body>


    <div class="document">
      <div class="documentwrapper">
          <div class="body" role="main">
            
  <section id="module-http.server">
<span id="http-server-http-servers"></span><h1><code class="xref py py-mod docutils literal notranslate"><span class="pre">http.server</span></code> --- HTTP 服务器</h1>
<p><strong>源代码：</strong> <a class="reference external" href="https://github.com/python/cpython/tree/3.12/Lib/http/server.py">Lib/http/server.py</a><span class="link-target"> [https://github.com/python/cpython/tree/3.12/Lib/http/server.py]</span></p>
<hr class="docutils" id="index-0" />
<p>这个模块定义了用于实现 HTTP 服务器的类。</p>
<div class="admonition warning">
<p class="admonition-title">警告</p>
<p><a class="reference internal" href="#module-http.server" title="http.server: HTTP server and request handlers."><code class="xref py py-mod docutils literal notranslate"><span class="pre">http.server</span></code></a> 不推荐用于生产环境。它仅仅实现了 <a class="reference internal" href="#http-server-security"><span class="std std-ref">basic security checks</span></a> 的要求。</p>
</div>
<div class="availability docutils container">
<p><a class="reference internal" href="intro.xhtml#availability"><span class="std std-ref">可用性</span></a>: 非 Emscripten，非 WASI。</p>
<p>此模块在 WebAssembly 平台 <code class="docutils literal notranslate"><span class="pre">wasm32-emscripten</span></code> 和 <code class="docutils literal notranslate"><span class="pre">wasm32-wasi</span></code> 上不适用或不可用。 请参阅 <a class="reference internal" href="intro.xhtml#wasm-availability"><span class="std std-ref">WebAssembly 平台</span></a> 了解详情。</p>
</div>
<p><a class="reference internal" href="#http.server.HTTPServer" title="http.server.HTTPServer"><code class="xref py py-class docutils literal notranslate"><span class="pre">HTTPServer</span></code></a> 是 <a class="reference internal" href="socketserver.xhtml#socketserver.TCPServer" title="socketserver.TCPServer"><code class="xref py py-class docutils literal notranslate"><span class="pre">socketserver.TCPServer</span></code></a> 的一个子类。它会创建和侦听 HTTP 套接字，并将请求分发给处理程序。创建和运行 HTTP 服务器的代码类似如下所示：</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="n">server_class</span><span class="o">=</span><span class="n">HTTPServer</span><span class="p">,</span> <span class="n">handler_class</span><span class="o">=</span><span class="n">BaseHTTPRequestHandler</span><span class="p">):</span>
    <span class="n">server_address</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="mi">8000</span><span class="p">)</span>
    <span class="n">httpd</span> <span class="o">=</span> <span class="n">server_class</span><span class="p">(</span><span class="n">server_address</span><span class="p">,</span> <span class="n">handler_class</span><span class="p">)</span>
    <span class="n">httpd</span><span class="o">.</span><span class="n">serve_forever</span><span class="p">()</span>
</pre></div>
</div>
<dl class="py class">
<dt class="sig sig-object py" id="http.server.HTTPServer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">http.server.</span></span><span class="sig-name descname"><span class="pre">HTTPServer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">server_address</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">RequestHandlerClass</span></span></em><span class="sig-paren">)</span></dt>
<dd><p>该类基于 <a class="reference internal" href="socketserver.xhtml#socketserver.TCPServer" title="socketserver.TCPServer"><code class="xref py py-class docutils literal notranslate"><span class="pre">TCPServer</span></code></a> 类，并在实例变量 <code class="xref py py-attr docutils literal notranslate"><span class="pre">server_name</span></code> 和 <code class="xref py py-attr docutils literal notranslate"><span class="pre">server_port</span></code> 中保存 HTTP 服务器地址。处理程序可通过实例变量 <code class="xref py py-attr docutils literal notranslate"><span class="pre">server</span></code> 访问 HTTP 服务器。</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="http.server.ThreadingHTTPServer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">http.server.</span></span><span class="sig-name descname"><span class="pre">ThreadingHTTPServer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">server_address</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">RequestHandlerClass</span></span></em><span class="sig-paren">)</span></dt>
<dd><p>该类相似于 HTTPServer ，只是会利用 <a class="reference internal" href="socketserver.xhtml#socketserver.ThreadingMixIn" title="socketserver.ThreadingMixIn"><code class="xref py py-class docutils literal notranslate"><span class="pre">ThreadingMixIn</span></code></a> 对请求进行多线程处理。当需要对 Web 浏览器预先打开套接字进行处理时，这就很有用，这时 <a class="reference internal" href="#http.server.HTTPServer" title="http.server.HTTPServer"><code class="xref py py-class docutils literal notranslate"><span class="pre">HTTPServer</span></code></a> 会一直等待请求。</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 3.7.</span></p>
</div>
</dd></dl>

<p>实例化 <a class="reference internal" href="#http.server.HTTPServer" title="http.server.HTTPServer"><code class="xref py py-class docutils literal notranslate"><span class="pre">HTTPServer</span></code></a> 和 <a class="reference internal" href="#http.server.ThreadingHTTPServer" title="http.server.ThreadingHTTPServer"><code class="xref py py-class docutils literal notranslate"><span class="pre">ThreadingHTTPServer</span></code></a> 时，必须给出一个 <em>RequestHandlerClass</em>，本模块提供了该对象的三种变体：</p>
<dl class="py class">
<dt class="sig sig-object py" id="http.server.BaseHTTPRequestHandler">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">http.server.</span></span><span class="sig-name descname"><span class="pre">BaseHTTPRequestHandler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">request</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">client_address</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">server</span></span></em><span class="sig-paren">)</span></dt>
<dd><p>这个类用于处理到达服务器的 HTTP 请求。 它本身无法响应任何实际的 HTTP 请求；它必须被子类化以处理每个请求方法（例如 GET 或 POST）。 <a class="reference internal" href="#http.server.BaseHTTPRequestHandler" title="http.server.BaseHTTPRequestHandler"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseHTTPRequestHandler</span></code></a> 提供了许多供子类使用的类和实例变量以及方法。</p>
<p>这个处理器将解析请求和标头，然后调用特定请求类型对应的方法。 方法名称将根据请求来构造。 例如，对于请求方法 <code class="docutils literal notranslate"><span class="pre">SPAM</span></code>，将不带参数地调用 <code class="xref py py-meth docutils literal notranslate"><span class="pre">do_SPAM()</span></code> 方法。 所有相关信息会被保存在该处理器的实例变量中。 子类不重写或扩展 <code class="xref py py-meth docutils literal notranslate"><span class="pre">__init__()</span></code> 方法。</p>
<p><a class="reference internal" href="#http.server.BaseHTTPRequestHandler" title="http.server.BaseHTTPRequestHandler"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseHTTPRequestHandler</span></code></a> 具有下列实例变量:</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="http.server.BaseHTTPRequestHandler.client_address">
<span class="sig-name descname"><span class="pre">client_address</span></span></dt>
<dd><p>包含 <code class="docutils literal notranslate"><span class="pre">(host,</span> <span class="pre">port)</span></code> 形式的指向客户端地址的元组。</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="http.server.BaseHTTPRequestHandler.server">
<span class="sig-name descname"><span class="pre">server</span></span></dt>
<dd><p>包含服务器实例。</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="http.server.BaseHTTPRequestHandler.close_connection">
<span class="sig-name descname"><span class="pre">close_connection</span></span></dt>
<dd><p>应当在 <a class="reference internal" href="#http.server.BaseHTTPRequestHandler.handle_one_request" title="http.server.BaseHTTPRequestHandler.handle_one_request"><code class="xref py py-meth docutils literal notranslate"><span class="pre">handle_one_request()</span></code></a> 返回之前设定的布尔值，指明是否要期待另一个请求，还是应当关闭连接。</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="http.server.BaseHTTPRequestHandler.requestline">
<span class="sig-name descname"><span class="pre">requestline</span></span></dt>
<dd><p>包含 HTTP 请求行的字符串表示。 末尾的 CRLF 会被去除。 该属性应当由 <a class="reference internal" href="#http.server.BaseHTTPRequestHandler.handle_one_request" title="http.server.BaseHTTPRequestHandler.handle_one_request"><code class="xref py py-meth docutils literal notranslate"><span class="pre">handle_one_request()</span></code></a> 来设定。 如果无有效请求行被处理，则它应当被设为空字符串。</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="http.server.BaseHTTPRequestHandler.command">
<span class="sig-name descname"><span class="pre">command</span></span></dt>
<dd><p>包含具体的命令（请求类型）。 例如 <code class="docutils literal notranslate"><span class="pre">'GET'</span></code>。</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="http.server.BaseHTTPRequestHandler.path">
<span class="sig-name descname"><span class="pre">path</span></span></dt>
<dd><p>包含请求路径。如果URL的查询部分存在， <code class="docutils literal notranslate"><span class="pre">path</span></code> 会包含这个查询部分。使用 <span class="target" id="index-6"></span><a class="rfc reference external" href="https://datatracker.ietf.org/doc/html/rfc3986.html"><strong>RFC 3986</strong></a><span class="link-target"> [https://datatracker.ietf.org/doc/html/rfc3986.html]</span> 的术语来说，在这里， <code class="docutils literal notranslate"><span class="pre">path</span></code> 包含 <code class="docutils literal notranslate"><span class="pre">hier-part</span></code> 和 <code class="docutils literal notranslate"><span class="pre">query</span></code> 。</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="http.server.BaseHTTPRequestHandler.request_version">
<span class="sig-name descname"><span class="pre">request_version</span></span></dt>
<dd><p>包含请求的版本字符串。 例如 <code class="docutils literal notranslate"><span class="pre">'HTTP/1.0'</span></code>。</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="http.server.BaseHTTPRequestHandler.headers">
<span class="sig-name descname"><span class="pre">headers</span></span></dt>
<dd><p>存放由 <a class="reference internal" href="#http.server.BaseHTTPRequestHandler.MessageClass" title="http.server.BaseHTTPRequestHandler.MessageClass"><code class="xref py py-attr docutils literal notranslate"><span class="pre">MessageClass</span></code></a> 类变量所指定的类的实例。 该实例会解析并管理 HTTP 请求中的标头。 <a class="reference internal" href="http.client.xhtml#module-http.client" title="http.client: HTTP and HTTPS protocol client (requires sockets)."><code class="xref py py-mod docutils literal notranslate"><span class="pre">http.client</span></code></a> 中的 <a class="reference internal" href="http.client.xhtml#http.client.parse_headers" title="http.client.parse_headers"><code class="xref py py-func docutils literal notranslate"><span class="pre">parse_headers()</span></code></a> 函数将被用来解析标头并且它需要 HTTP 请求提供一个有效的 <span class="target" id="index-7"></span><a class="rfc reference external" href="https://datatracker.ietf.org/doc/html/rfc2822.html"><strong>RFC 2822</strong></a><span class="link-target"> [https://datatracker.ietf.org/doc/html/rfc2822.html]</span> 风格的标头。</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="http.server.BaseHTTPRequestHandler.rfile">
<span class="sig-name descname"><span class="pre">rfile</span></span></dt>
<dd><p>一个 <a class="reference internal" href="io.xhtml#io.BufferedIOBase" title="io.BufferedIOBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">io.BufferedIOBase</span></code></a> 输入流，准备从可选的输入数据的开头进行读取。</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="http.server.BaseHTTPRequestHandler.wfile">
<span class="sig-name descname"><span class="pre">wfile</span></span></dt>
<dd><p>包含用于写入响应并发回给客户端的输出流。 在写入流时必须正确遵守 HTTP 协议以便成功地实现与 HTTP 客户端的互操作。</p>
<div class="versionchanged">
<p><span class="versionmodified changed">在 3.6 版本发生变更: </span>这是一个 <a class="reference internal" href="io.xhtml#io.BufferedIOBase" title="io.BufferedIOBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">io.BufferedIOBase</span></code></a> 流。</p>
</div>
</dd></dl>

<p><a class="reference internal" href="#http.server.BaseHTTPRequestHandler" title="http.server.BaseHTTPRequestHandler"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseHTTPRequestHandler</span></code></a> 具有下列属性：</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="http.server.BaseHTTPRequestHandler.server_version">
<span class="sig-name descname"><span class="pre">server_version</span></span></dt>
<dd><p>指定服务器软件版本。 你可能会想要重写该属性。 该属性的格式为多个以空格分隔的字符串，其中每个字符串的形式为 name[/version]。 例如 <code class="docutils literal notranslate"><span class="pre">'BaseHTTP/0.2'</span></code>。</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="http.server.BaseHTTPRequestHandler.sys_version">
<span class="sig-name descname"><span class="pre">sys_version</span></span></dt>
<dd><p>包含 Python 系统版本，采用 <a class="reference internal" href="#http.server.BaseHTTPRequestHandler.version_string" title="http.server.BaseHTTPRequestHandler.version_string"><code class="xref py py-attr docutils literal notranslate"><span class="pre">version_string</span></code></a> 方法和 <a class="reference internal" href="#http.server.BaseHTTPRequestHandler.server_version" title="http.server.BaseHTTPRequestHandler.server_version"><code class="xref py py-attr docutils literal notranslate"><span class="pre">server_version</span></code></a> 类变量所支持的形式。 例如 <code class="docutils literal notranslate"><span class="pre">'Python/1.4'</span></code>。</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="http.server.BaseHTTPRequestHandler.error_message_format">
<span class="sig-name descname"><span class="pre">error_message_format</span></span></dt>
<dd><p>指定应当被 <a class="reference internal" href="#http.server.BaseHTTPRequestHandler.send_error" title="http.server.BaseHTTPRequestHandler.send_error"><code class="xref py py-meth docutils literal notranslate"><span class="pre">send_error()</span></code></a> 方法用来构建发给客户端的错误响应的格式字符串。 该字符串应使用来自 <a class="reference internal" href="#http.server.BaseHTTPRequestHandler.responses" title="http.server.BaseHTTPRequestHandler.responses"><code class="xref py py-attr docutils literal notranslate"><span class="pre">responses</span></code></a> 的变量根据传给 <a class="reference internal" href="#http.server.BaseHTTPRequestHandler.send_error" title="http.server.BaseHTTPRequestHandler.send_error"><code class="xref py py-meth docutils literal notranslate"><span class="pre">send_error()</span></code></a> 的状态码来填充默认值。</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="http.server.BaseHTTPRequestHandler.error_content_type">
<span class="sig-name descname"><span class="pre">error_content_type</span></span></dt>
<dd><p>指定发送给客户端的错误响应的 Content-Type HTTP 标头。 默认值为 <code class="docutils literal notranslate"><span class="pre">'text/html'</span></code>。</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="http.server.BaseHTTPRequestHandler.protocol_version">
<span class="sig-name descname"><span class="pre">protocol_version</span></span></dt>
<dd><p>指定服务器所符合的 HTTP 版本。 它会在响应中发送以便让客户端知道服务器对于未来请求的通信能力。 如果设置为 <code class="docutils literal notranslate"><span class="pre">'HTTP/1.1'</span></code>，服务器将允许 HTTP 持久连接；但是，你的服务器 <em>必须</em> 在所有对客户端的响应中包括一个准确的 <code class="docutils literal notranslate"><span class="pre">Content-Length</span></code> 标头 (使用 <a class="reference internal" href="#http.server.BaseHTTPRequestHandler.send_header" title="http.server.BaseHTTPRequestHandler.send_header"><code class="xref py py-meth docutils literal notranslate"><span class="pre">send_header()</span></code></a>)。 为了保持向下兼容性，该设置默认为 <code class="docutils literal notranslate"><span class="pre">'HTTP/1.0'</span></code>。</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="http.server.BaseHTTPRequestHandler.MessageClass">
<span class="sig-name descname"><span class="pre">MessageClass</span></span></dt>
<dd><p>指定一个 <a class="reference internal" href="email.compat32-message.xhtml#email.message.Message" title="email.message.Message"><code class="xref py py-class docutils literal notranslate"><span class="pre">email.message.Message</span></code></a> 这样的类来解析 HTTP 标头。 通常该属性不会被重写，其默认值为 <a class="reference internal" href="http.client.xhtml#http.client.HTTPMessage" title="http.client.HTTPMessage"><code class="xref py py-class docutils literal notranslate"><span class="pre">http.client.HTTPMessage</span></code></a>。</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="http.server.BaseHTTPRequestHandler.responses">
<span class="sig-name descname"><span class="pre">responses</span></span></dt>
<dd><p>该属性包含一个整数错误代码与由短消息和长消息组成的二元组的映射。 例如，<code class="docutils literal notranslate"><span class="pre">{code:</span> <span class="pre">(shortmessage,</span> <span class="pre">longmessage)}</span></code>。 <em>shortmessage</em> 通常是作为消息响应中的 <em>message</em> 键，而 <em>longmessage</em> 则是作为 <em>explain</em> 键。 该属性会被 <a class="reference internal" href="#http.server.BaseHTTPRequestHandler.send_response_only" title="http.server.BaseHTTPRequestHandler.send_response_only"><code class="xref py py-meth docutils literal notranslate"><span class="pre">send_response_only()</span></code></a> 和 <a class="reference internal" href="#http.server.BaseHTTPRequestHandler.send_error" title="http.server.BaseHTTPRequestHandler.send_error"><code class="xref py py-meth docutils literal notranslate"><span class="pre">send_error()</span></code></a> 方法所使用。</p>
</dd></dl>

<p><a class="reference internal" href="#http.server.BaseHTTPRequestHandler" title="http.server.BaseHTTPRequestHandler"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseHTTPRequestHandler</span></code></a> 实例具有下列方法:</p>
<dl class="py method">
<dt class="sig sig-object py" id="http.server.BaseHTTPRequestHandler.handle">
<span class="sig-name descname"><span class="pre">handle</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span></dt>
<dd><p>调用 <a class="reference internal" href="#http.server.BaseHTTPRequestHandler.handle_one_request" title="http.server.BaseHTTPRequestHandler.handle_one_request"><code class="xref py py-meth docutils literal notranslate"><span class="pre">handle_one_request()</span></code></a> 一次（或者如果启用了永久连接则为多次）来处理传入的 HTTP 请求。 你应该永远不需要重写它；而是要实现适当的 <code class="xref py py-meth docutils literal notranslate"><span class="pre">do_*()</span></code> 方法。</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="http.server.BaseHTTPRequestHandler.handle_one_request">
<span class="sig-name descname"><span class="pre">handle_one_request</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span></dt>
<dd><p>此方法将解析并请请求分配给适当的 <code class="xref py py-meth docutils literal notranslate"><span class="pre">do_*()</span></code> 方法。 你应该永远不需要重写它。</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="http.server.BaseHTTPRequestHandler.handle_expect_100">
<span class="sig-name descname"><span class="pre">handle_expect_100</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span></dt>
<dd><p>当一个符合 HTTP/1.1 标准的服务器接收到一个 <code class="docutils literal notranslate"><span class="pre">Expect:</span> <span class="pre">100-continue</span></code> 请求标头时它会以一个 <code class="docutils literal notranslate"><span class="pre">100</span> <span class="pre">Continue</span></code> 加 <code class="docutils literal notranslate"><span class="pre">200</span> <span class="pre">OK</span></code> 标头作为响应。 如果服务器不希望客户端继续则可以通过重写来引发一个错误。 例如服务器可以选择发送 <code class="docutils literal notranslate"><span class="pre">417</span> <span class="pre">Expectation</span> <span class="pre">Failed</span></code> 作为响应标头并 <code class="docutils literal notranslate"><span class="pre">return</span> <span class="pre">False</span></code>。</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 3.2.</span></p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="http.server.BaseHTTPRequestHandler.send_error">
<span class="sig-name descname"><span class="pre">send_error</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">code</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">message</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">explain</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span></dt>
<dd><p>发送并记录回复给客户端的完整的错误信息。 数字形式的 <em>code</em> 指明 HTTP 错误代码，可选的 <em>message</em> 为简短的易于人类阅读的错误描述。 <em>explain</em> 参数可被用于提供更详细的错误信息；它将使用 <a class="reference internal" href="#http.server.BaseHTTPRequestHandler.error_message_format" title="http.server.BaseHTTPRequestHandler.error_message_format"><code class="xref py py-attr docutils literal notranslate"><span class="pre">error_message_format</span></code></a> 属性来进行格式化并在一组完整的标头之后作为响应体被发送。 <a class="reference internal" href="#http.server.BaseHTTPRequestHandler.responses" title="http.server.BaseHTTPRequestHandler.responses"><code class="xref py py-attr docutils literal notranslate"><span class="pre">responses</span></code></a> 属性保存了 <em>message</em> 和 <em>explain</em> 的默认值并将在未提供值时被使用；对于未知代码这两者的默认值均为字符串 <code class="docutils literal notranslate"><span class="pre">???</span></code>。 如果方法为 HEAD 或响应代码为下列值一则响应体将为空: <code class="samp docutils literal notranslate"><span class="pre">1</span><em><span class="pre">xx</span></em></code>, <code class="docutils literal notranslate"><span class="pre">204</span> <span class="pre">No</span> <span class="pre">Content</span></code>, <code class="docutils literal notranslate"><span class="pre">205</span> <span class="pre">Reset</span> <span class="pre">Content</span></code>, <code class="docutils literal notranslate"><span class="pre">304</span> <span class="pre">Not</span> <span class="pre">Modified</span></code>。</p>
<div class="versionchanged">
<p><span class="versionmodified changed">在 3.4 版本发生变更: </span>错误响应包括一个 Content-Length 标头。 增加了 <em>explain</em> 参数。</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="http.server.BaseHTTPRequestHandler.send_response">
<span class="sig-name descname"><span class="pre">send_response</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">code</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">message</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span></dt>
<dd><p>将一个响应标头添加到标头缓冲区并记录被接受的请求。 HTTP 响应行会被写入到内部缓冲区，后面是 <em>Server</em> 和 <em>Date</em> 标头。 这两个标头的值将分别通过 <a class="reference internal" href="#http.server.BaseHTTPRequestHandler.version_string" title="http.server.BaseHTTPRequestHandler.version_string"><code class="xref py py-meth docutils literal notranslate"><span class="pre">version_string()</span></code></a> 和 <a class="reference internal" href="#http.server.BaseHTTPRequestHandler.date_time_string" title="http.server.BaseHTTPRequestHandler.date_time_string"><code class="xref py py-meth docutils literal notranslate"><span class="pre">date_time_string()</span></code></a> 方法获取。 如果服务器不打算使用 <a class="reference internal" href="#http.server.BaseHTTPRequestHandler.send_header" title="http.server.BaseHTTPRequestHandler.send_header"><code class="xref py py-meth docutils literal notranslate"><span class="pre">send_header()</span></code></a> 方法发送任何其他标头，则 <a class="reference internal" href="#http.server.BaseHTTPRequestHandler.send_response" title="http.server.BaseHTTPRequestHandler.send_response"><code class="xref py py-meth docutils literal notranslate"><span class="pre">send_response()</span></code></a> 后面应该跟一个 <a class="reference internal" href="#http.server.BaseHTTPRequestHandler.end_headers" title="http.server.BaseHTTPRequestHandler.end_headers"><code class="xref py py-meth docutils literal notranslate"><span class="pre">end_headers()</span></code></a> 调用。</p>
<div class="versionchanged">
<p><span class="versionmodified changed">在 3.3 版本发生变更: </span>标头会被存储到内部缓冲区并且需要显式地调用 <a class="reference internal" href="#http.server.BaseHTTPRequestHandler.end_headers" title="http.server.BaseHTTPRequestHandler.end_headers"><code class="xref py py-meth docutils literal notranslate"><span class="pre">end_headers()</span></code></a>。</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="http.server.BaseHTTPRequestHandler.send_header">
<span class="sig-name descname"><span class="pre">send_header</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">keyword</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span></dt>
<dd><p>将 HTTP 标头添加到内部缓冲区，它将在 <a class="reference internal" href="#http.server.BaseHTTPRequestHandler.end_headers" title="http.server.BaseHTTPRequestHandler.end_headers"><code class="xref py py-meth docutils literal notranslate"><span class="pre">end_headers()</span></code></a> 或 <a class="reference internal" href="#http.server.BaseHTTPRequestHandler.flush_headers" title="http.server.BaseHTTPRequestHandler.flush_headers"><code class="xref py py-meth docutils literal notranslate"><span class="pre">flush_headers()</span></code></a> 被发起调用时写入输出流。 <em>keyword</em> 应当指定标头关键字，并以 <em>value</em> 指定其值。 请注意，在 send_header 调用结束之后，必须调用 <a class="reference internal" href="#http.server.BaseHTTPRequestHandler.end_headers" title="http.server.BaseHTTPRequestHandler.end_headers"><code class="xref py py-meth docutils literal notranslate"><span class="pre">end_headers()</span></code></a> 以便完成操作。</p>
<div class="versionchanged">
<p><span class="versionmodified changed">在 3.2 版本发生变更: </span>标头将被存入内部缓冲区。</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="http.server.BaseHTTPRequestHandler.send_response_only">
<span class="sig-name descname"><span class="pre">send_response_only</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">code</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">message</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span></dt>
<dd><p>只发送响应标头，用于当 <code class="docutils literal notranslate"><span class="pre">100</span> <span class="pre">Continue</span></code> 响应被服务器发送给客户端的场合。 标头不会被缓冲而是直接发送到输出流。 如果未指定 <em>message</em>，则会发送与响应 <em>code</em>  相对应的 HTTP 消息。</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 3.2.</span></p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="http.server.BaseHTTPRequestHandler.end_headers">
<span class="sig-name descname"><span class="pre">end_headers</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span></dt>
<dd><p>将一个空行（指明响应中 HTTP 标头的结束）添加到标头缓冲区并调用 <a class="reference internal" href="#http.server.BaseHTTPRequestHandler.flush_headers" title="http.server.BaseHTTPRequestHandler.flush_headers"><code class="xref py py-meth docutils literal notranslate"><span class="pre">flush_headers()</span></code></a>。</p>
<div class="versionchanged">
<p><span class="versionmodified changed">在 3.2 版本发生变更: </span>已缓冲的标头会被写入到输出流。</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="http.server.BaseHTTPRequestHandler.flush_headers">
<span class="sig-name descname"><span class="pre">flush_headers</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span></dt>
<dd><p>最终将标头发送到输出流并清空内部标头缓冲区。</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 3.3.</span></p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="http.server.BaseHTTPRequestHandler.log_request">
<span class="sig-name descname"><span class="pre">log_request</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">code</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'-'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'-'</span></span></em><span class="sig-paren">)</span></dt>
<dd><p>记录一次被接受（成功）的请求。 <em>code</em> 应当指定与请求相关联的 HTTP 代码。 如果请求的大小可用，则它应当作为 <em>size</em> 形参传入。</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="http.server.BaseHTTPRequestHandler.log_error">
<span class="sig-name descname"><span class="pre">log_error</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">...</span></span></em><span class="sig-paren">)</span></dt>
<dd><p>当请求无法完成时记录一次错误。 默认情况下，它会将消息传给 <a class="reference internal" href="#http.server.BaseHTTPRequestHandler.log_message" title="http.server.BaseHTTPRequestHandler.log_message"><code class="xref py py-meth docutils literal notranslate"><span class="pre">log_message()</span></code></a>，因此它接受同样的参数 (<em>format</em> 和一些额外的值)。</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="http.server.BaseHTTPRequestHandler.log_message">
<span class="sig-name descname"><span class="pre">log_message</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">format</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">...</span></span></em><span class="sig-paren">)</span></dt>
<dd><p>将任意一条消息记录到 <code class="docutils literal notranslate"><span class="pre">sys.stderr</span></code>。 此方法通常会被重写以创建自定义的错误日志记录机制。 <em>format</em> 参数是标准 printf 风格的格式字符串，其中会将传给 <a class="reference internal" href="#http.server.BaseHTTPRequestHandler.log_message" title="http.server.BaseHTTPRequestHandler.log_message"><code class="xref py py-meth docutils literal notranslate"><span class="pre">log_message()</span></code></a> 的额外参数用作格式化操作的输入。 每条消息日志记录的开头都会加上客户端 IP 地址和当前日期时间。</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="http.server.BaseHTTPRequestHandler.version_string">
<span class="sig-name descname"><span class="pre">version_string</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span></dt>
<dd><p>返回服务器软件的版本字符串。 该值为 <a class="reference internal" href="#http.server.BaseHTTPRequestHandler.server_version" title="http.server.BaseHTTPRequestHandler.server_version"><code class="xref py py-attr docutils literal notranslate"><span class="pre">server_version</span></code></a> 与 <a class="reference internal" href="#http.server.BaseHTTPRequestHandler.sys_version" title="http.server.BaseHTTPRequestHandler.sys_version"><code class="xref py py-attr docutils literal notranslate"><span class="pre">sys_version</span></code></a> 属性的组合。</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="http.server.BaseHTTPRequestHandler.date_time_string">
<span class="sig-name descname"><span class="pre">date_time_string</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">timestamp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span></dt>
<dd><p>返回由 <em>timestamp</em> 所给定的日期和时间（参数应为 <code class="docutils literal notranslate"><span class="pre">None</span></code> 或为 <a class="reference internal" href="time.xhtml#time.time" title="time.time"><code class="xref py py-func docutils literal notranslate"><span class="pre">time.time()</span></code></a> 所返回的格式），格式化为一个消息标头。 如果省略 <em>timestamp</em>，则会使用当前日期和时间。</p>
<p>结果看起来像 <code class="docutils literal notranslate"><span class="pre">'Sun,</span> <span class="pre">06</span> <span class="pre">Nov</span> <span class="pre">1994</span> <span class="pre">08:49:37</span> <span class="pre">GMT'</span></code>。</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="http.server.BaseHTTPRequestHandler.log_date_time_string">
<span class="sig-name descname"><span class="pre">log_date_time_string</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span></dt>
<dd><p>返回当前的日期和时间，为日志格式化</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="http.server.BaseHTTPRequestHandler.address_string">
<span class="sig-name descname"><span class="pre">address_string</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span></dt>
<dd><p>返回客户端的地址</p>
<div class="versionchanged">
<p><span class="versionmodified changed">在 3.3 版本发生变更: </span>在之前版本中，会执行一次名称查找。 为了避免名称解析的时延，现在将总是返回 IP 地址。</p>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="http.server.SimpleHTTPRequestHandler">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">http.server.</span></span><span class="sig-name descname"><span class="pre">SimpleHTTPRequestHandler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">request</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">client_address</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">server</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">directory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span></dt>
<dd><p>这个类会为目录 <em>directory</em> 及以下的文件提供发布服务，或者如果未提供 <em>directory</em> 则为当前目录，直接将目录结构映射到 HTTP 请求。</p>
<div class="versionchanged">
<p><span class="versionmodified changed">在 3.7 版本发生变更: </span>增加了 <em>directory</em> 形参。</p>
</div>
<div class="versionchanged">
<p><span class="versionmodified changed">在 3.9 版本发生变更: </span><em>directory</em> 形参接受一个 <a class="reference internal" href="../glossary.xhtml#term-path-like-object"><span class="xref std std-term">path-like object</span></a>。</p>
</div>
<p>诸如解析请求之类的大量工作都是由基类 <a class="reference internal" href="#http.server.BaseHTTPRequestHandler" title="http.server.BaseHTTPRequestHandler"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseHTTPRequestHandler</span></code></a> 完成的。本类实现了 <a class="reference internal" href="#http.server.SimpleHTTPRequestHandler.do_GET" title="http.server.SimpleHTTPRequestHandler.do_GET"><code class="xref py py-func docutils literal notranslate"><span class="pre">do_GET()</span></code></a> 和 <a class="reference internal" href="#http.server.SimpleHTTPRequestHandler.do_HEAD" title="http.server.SimpleHTTPRequestHandler.do_HEAD"><code class="xref py py-func docutils literal notranslate"><span class="pre">do_HEAD()</span></code></a> 函数。</p>
<p>以下是 <a class="reference internal" href="#http.server.SimpleHTTPRequestHandler" title="http.server.SimpleHTTPRequestHandler"><code class="xref py py-class docutils literal notranslate"><span class="pre">SimpleHTTPRequestHandler</span></code></a> 的类属性。</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="http.server.SimpleHTTPRequestHandler.server_version">
<span class="sig-name descname"><span class="pre">server_version</span></span></dt>
<dd><p>这会是 <code class="docutils literal notranslate"><span class="pre">&quot;SimpleHTTP/&quot;</span> <span class="pre">+</span> <span class="pre">__version__</span></code>，其中 <code class="docutils literal notranslate"><span class="pre">__version__</span></code> 定义于模块级别。</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="http.server.SimpleHTTPRequestHandler.extensions_map">
<span class="sig-name descname"><span class="pre">extensions_map</span></span></dt>
<dd><p>将后缀映射为 MIME 类型的字典，其中包含了覆盖系统默认值的自定义映射关系。不区分大小写，因此字典键只应为小写值。</p>
<div class="versionchanged">
<p><span class="versionmodified changed">在 3.9 版本发生变更: </span>此字典不再填充默认的系统映射，而只包含覆盖值。</p>
</div>
</dd></dl>

<p><a class="reference internal" href="#http.server.SimpleHTTPRequestHandler" title="http.server.SimpleHTTPRequestHandler"><code class="xref py py-class docutils literal notranslate"><span class="pre">SimpleHTTPRequestHandler</span></code></a> 类定义了以下方法：</p>
<dl class="py method">
<dt class="sig sig-object py" id="http.server.SimpleHTTPRequestHandler.do_HEAD">
<span class="sig-name descname"><span class="pre">do_HEAD</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span></dt>
<dd><p>本方法为 <code class="docutils literal notranslate"><span class="pre">'HEAD'</span></code> 请求提供服务：它将发送等同于 <code class="docutils literal notranslate"><span class="pre">GET</span></code> 请求的头文件。关于合法头部信息的更完整解释，请参阅 <a class="reference internal" href="#http.server.SimpleHTTPRequestHandler.do_GET" title="http.server.SimpleHTTPRequestHandler.do_GET"><code class="xref py py-meth docutils literal notranslate"><span class="pre">do_GET()</span></code></a> 方法。</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="http.server.SimpleHTTPRequestHandler.do_GET">
<span class="sig-name descname"><span class="pre">do_GET</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span></dt>
<dd><p>通过将请求解释为相对于当前工作目录的路径，将请求映射到某个本地文件。</p>
<p>如果请求被映射到目录，则会依次检查该目录是否存在 <code class="docutils literal notranslate"><span class="pre">index.html</span></code> 或 <code class="docutils literal notranslate"><span class="pre">index.htm</span></code> 文件。若存在则返回文件内容；否则会调用  <code class="xref py py-meth docutils literal notranslate"><span class="pre">list_directory()</span></code> 方法生成目录列表。本方法将利用 <a class="reference internal" href="os.xhtml#os.listdir" title="os.listdir"><code class="xref py py-func docutils literal notranslate"><span class="pre">os.listdir()</span></code></a> 扫描目录，如果 <a class="reference internal" href="os.xhtml#os.listdir" title="os.listdir"><code class="xref py py-func docutils literal notranslate"><span class="pre">listdir()</span></code></a> 失败，则返回 <code class="docutils literal notranslate"><span class="pre">404</span></code> 出错应答。</p>
<p>如果请求被映射到文件，则会打开该文件。 打开文件时的任何 <a class="reference internal" href="exceptions.xhtml#OSError" title="OSError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">OSError</span></code></a> 异常都会被映射为 <code class="docutils literal notranslate"><span class="pre">404</span></code>, <code class="docutils literal notranslate"><span class="pre">'File</span> <span class="pre">not</span> <span class="pre">found'</span></code> 错误。 如果请求中带有 <code class="docutils literal notranslate"><span class="pre">'If-Modified-Since'</span></code> 标头，而在此时间点之后文件未作修改，则会发送 <code class="docutils literal notranslate"><span class="pre">304</span></code>, <code class="docutils literal notranslate"><span class="pre">'Not</span> <span class="pre">Modified'</span></code> 的响应。 否则会调用 <code class="xref py py-meth docutils literal notranslate"><span class="pre">guess_type()</span></code> 方法猜测内容的类型，该方法会反过来用到 <em>extensions_map</em> 变量，并返回文件内容。</p>
<p>将会输出 <code class="docutils literal notranslate"><span class="pre">'Content-type:'</span></code> 头部信息，带上猜出的内容类型，然后是 <code class="docutils literal notranslate"><span class="pre">'Content-Length:'</span></code> 头部信息，带有文件的大小，以及 <code class="docutils literal notranslate"><span class="pre">'Last-Modified:'</span></code> 头部信息，带有文件的修改时间。</p>
<p>后面是一个空行，标志着头部信息的结束，然后输出文件的内容。如果文件的 MIME 类型以 <code class="docutils literal notranslate"><span class="pre">text/</span></code> 开头，文件将以文本模式打开；否则将使用二进制模式。</p>
<p>示例用法请见在 <a class="reference external" href="https://github.com/python/cpython/tree/3.12/Lib/http/server.py">Lib/http/server.py</a><span class="link-target"> [https://github.com/python/cpython/tree/3.12/Lib/http/server.py]</span> 中 <code class="docutils literal notranslate"><span class="pre">test</span></code> 函数的实现。</p>
<div class="versionchanged">
<p><span class="versionmodified changed">在 3.7 版本发生变更: </span>为 <code class="docutils literal notranslate"><span class="pre">'If-Modified-Since'</span></code> 头部信息提供支持。</p>
</div>
</dd></dl>

</dd></dl>

<p><a class="reference internal" href="#http.server.SimpleHTTPRequestHandler" title="http.server.SimpleHTTPRequestHandler"><code class="xref py py-class docutils literal notranslate"><span class="pre">SimpleHTTPRequestHandler</span></code></a> 类的用法可如下所示，以便创建一个非常简单的 Web 服务，为相对于当前目录的文件提供服务：</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">http.server</span>
<span class="kn">import</span> <span class="nn">socketserver</span>

<span class="n">PORT</span> <span class="o">=</span> <span class="mi">8000</span>

<span class="n">Handler</span> <span class="o">=</span> <span class="n">http</span><span class="o">.</span><span class="n">server</span><span class="o">.</span><span class="n">SimpleHTTPRequestHandler</span>

<span class="k">with</span> <span class="n">socketserver</span><span class="o">.</span><span class="n">TCPServer</span><span class="p">((</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">PORT</span><span class="p">),</span> <span class="n">Handler</span><span class="p">)</span> <span class="k">as</span> <span class="n">httpd</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;serving at port&quot;</span><span class="p">,</span> <span class="n">PORT</span><span class="p">)</span>
    <span class="n">httpd</span><span class="o">.</span><span class="n">serve_forever</span><span class="p">()</span>
</pre></div>
</div>
<p><a class="reference internal" href="#http.server.SimpleHTTPRequestHandler" title="http.server.SimpleHTTPRequestHandler"><code class="xref py py-class docutils literal notranslate"><span class="pre">SimpleHTTPRequestHandler</span></code></a> 也可以被子类化以便增强其行为，例如通过重写类属性 <code class="xref py py-attr docutils literal notranslate"><span class="pre">index_pages</span></code> 以使用不同的 index 文件名。</p>
<p id="http-server-cli"><a class="reference internal" href="#module-http.server" title="http.server: HTTP server and request handlers."><code class="xref py py-mod docutils literal notranslate"><span class="pre">http.server</span></code></a> 也可以使用解释器的 <a class="reference internal" href="../using/cmdline.xhtml#cmdoption-m"><code class="xref std std-option docutils literal notranslate"><span class="pre">-m</span></code></a> 参数直接调用。 与前面的例子类似，这将提供相对于当前目录的文件:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="o">-</span><span class="n">m</span> <span class="n">http</span><span class="o">.</span><span class="n">server</span>
</pre></div>
</div>
<p>服务器默认监听端口为8000。可以通过传递所需的端口号作为参数来覆盖默认值:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="o">-</span><span class="n">m</span> <span class="n">http</span><span class="o">.</span><span class="n">server</span> <span class="mi">9000</span>
</pre></div>
</div>
<p>默认情况下，服务器将自己绑定到所有接口。 选项 <cite>-b/--bind</cite> 指定了一个特定的地址，它应该与之绑定。 IPv4 和 IPv6 地址都被支持。例如，下面的命令使服务器只绑定到 localhost:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="o">-</span><span class="n">m</span> <span class="n">http</span><span class="o">.</span><span class="n">server</span> <span class="o">--</span><span class="n">bind</span> <span class="mf">127.0.0.1</span>
</pre></div>
</div>
<div class="versionchanged">
<p><span class="versionmodified changed">在 3.4 版本发生变更: </span>增加了 <code class="docutils literal notranslate"><span class="pre">--bind</span></code> 形参。</p>
</div>
<div class="versionchanged">
<p><span class="versionmodified changed">在 3.8 版本发生变更: </span>在 <code class="docutils literal notranslate"><span class="pre">--bind</span></code> 选项中支持 IPv6。</p>
</div>
<p>默认情况下，服务器使用当前目录。选项 <code class="docutils literal notranslate"><span class="pre">-d/--directory</span></code> 指定了一个它应该提供文件的目录。例如，下面的命令使用一个特定的目录:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="o">-</span><span class="n">m</span> <span class="n">http</span><span class="o">.</span><span class="n">server</span> <span class="o">--</span><span class="n">directory</span> <span class="o">/</span><span class="n">tmp</span><span class="o">/</span>
</pre></div>
</div>
<div class="versionchanged">
<p><span class="versionmodified changed">在 3.7 版本发生变更: </span>增加了 <code class="docutils literal notranslate"><span class="pre">--directory</span></code> 选项。</p>
</div>
<p>在默认情况下，服务器将遵循 HTTP/1.0 标准。 选项 <code class="docutils literal notranslate"><span class="pre">-p/--protocol</span></code> 指定了服务器所符合的 HTTP 版本。 例如，以下命令将运行一个符合 HTTP/1.1 标准的服务器:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="o">-</span><span class="n">m</span> <span class="n">http</span><span class="o">.</span><span class="n">server</span> <span class="o">--</span><span class="n">protocol</span> <span class="n">HTTP</span><span class="o">/</span><span class="mf">1.1</span>
</pre></div>
</div>
<div class="versionchanged">
<p><span class="versionmodified changed">在 3.11 版本发生变更: </span>增加了 <code class="docutils literal notranslate"><span class="pre">--protocol</span></code> 选项。</p>
</div>
<dl class="py class">
<dt class="sig sig-object py" id="http.server.CGIHTTPRequestHandler">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">http.server.</span></span><span class="sig-name descname"><span class="pre">CGIHTTPRequestHandler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">request</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">client_address</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">server</span></span></em><span class="sig-paren">)</span></dt>
<dd><p>该类可为当前及以下目录中的文件或输出 CGI 脚本提供服务。注意，把 HTTP 分层结构映射到本地目录结构，这与 <a class="reference internal" href="#http.server.SimpleHTTPRequestHandler" title="http.server.SimpleHTTPRequestHandler"><code class="xref py py-class docutils literal notranslate"><span class="pre">SimpleHTTPRequestHandler</span></code></a> 完全一样。</p>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>由 <a class="reference internal" href="#http.server.CGIHTTPRequestHandler" title="http.server.CGIHTTPRequestHandler"><code class="xref py py-class docutils literal notranslate"><span class="pre">CGIHTTPRequestHandler</span></code></a> 类运行的 CGI 脚本不能进行重定向操作（HTTP 代码302），因为在执行 CGI 脚本之前会发送代码 200（接下来就输出脚本）。这样状态码就冲突了。</p>
</div>
<p>然而，如果这个类猜测它是一个 CGI 脚本，那么就会运行该 CGI 脚本，而不是作为文件提供出去。 只会识别基于目录的 CGI —— 另有一种常用的服务器设置，即标识 CGI 脚本是通过特殊的扩展名。</p>
<p>如果请求指向 <code class="docutils literal notranslate"><span class="pre">cgi_directories</span></code> 以下的路径，<code class="xref py py-func docutils literal notranslate"><span class="pre">do_GET()</span></code> 和 <code class="xref py py-func docutils literal notranslate"><span class="pre">do_HEAD()</span></code> 函数已作修改，不是给出文件，而是运行 CGI 脚本并输出结果。</p>
<p><a class="reference internal" href="#http.server.CGIHTTPRequestHandler" title="http.server.CGIHTTPRequestHandler"><code class="xref py py-class docutils literal notranslate"><span class="pre">CGIHTTPRequestHandler</span></code></a> 定义了以下数据成员：</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="http.server.CGIHTTPRequestHandler.cgi_directories">
<span class="sig-name descname"><span class="pre">cgi_directories</span></span></dt>
<dd><p>默认为 <code class="docutils literal notranslate"><span class="pre">['/cgi-bin',</span> <span class="pre">'/htbin']</span></code>，视作 CGI 脚本所在目录。</p>
</dd></dl>

<p><a class="reference internal" href="#http.server.CGIHTTPRequestHandler" title="http.server.CGIHTTPRequestHandler"><code class="xref py py-class docutils literal notranslate"><span class="pre">CGIHTTPRequestHandler</span></code></a> 定义了以下方法：</p>
<dl class="py method">
<dt class="sig sig-object py" id="http.server.CGIHTTPRequestHandler.do_POST">
<span class="sig-name descname"><span class="pre">do_POST</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span></dt>
<dd><p>本方法服务于  <code class="docutils literal notranslate"><span class="pre">'POST'</span></code> 请求，仅用于 CGI 脚本。如果试图向非 CGI 网址发送 POST 请求，则会输出错误 501：Can only POST to CGI scripts&quot;。</p>
</dd></dl>

<p>请注意，为了保证安全性，CGI 脚本将以用户 nobody 的 UID 运行。CGI 脚本运行错误将被转换为错误 403。</p>
</dd></dl>

<p>通过在命令行传入 <code class="docutils literal notranslate"><span class="pre">--cgi</span></code> 参数，可以启用  <a class="reference internal" href="#http.server.CGIHTTPRequestHandler" title="http.server.CGIHTTPRequestHandler"><code class="xref py py-class docutils literal notranslate"><span class="pre">CGIHTTPRequestHandler</span></code></a> ：</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="o">-</span><span class="n">m</span> <span class="n">http</span><span class="o">.</span><span class="n">server</span> <span class="o">--</span><span class="n">cgi</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">警告</p>
<p><a class="reference internal" href="#http.server.CGIHTTPRequestHandler" title="http.server.CGIHTTPRequestHandler"><code class="xref py py-class docutils literal notranslate"><span class="pre">CGIHTTPRequestHandler</span></code></a> 和 <code class="docutils literal notranslate"><span class="pre">--cgi</span></code> 命令行选项不可供不受信任的客户端使用且容易受到恶意利用。 应当始终在安全的环境中使用。</p>
</div>
<section id="security-considerations">
<span id="http-server-security"></span><h2>安全考量</h2>
<p id="index-3">当处理请求时，<a class="reference internal" href="#http.server.SimpleHTTPRequestHandler" title="http.server.SimpleHTTPRequestHandler"><code class="xref py py-class docutils literal notranslate"><span class="pre">SimpleHTTPRequestHandler</span></code></a> 会解析符号链接，这有可能使得指定文件夹以外的文件被暴露。</p>
<p>较早版本的 Python 不会擦除从 <code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">-m</span> <span class="pre">http.server</span></code> 或默认的 <a class="reference internal" href="#http.server.BaseHTTPRequestHandler" title="http.server.BaseHTTPRequestHandler"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseHTTPRequestHandler</span></code></a> <code class="docutils literal notranslate"><span class="pre">.log_message</span></code> 实现发送到 stderr 的日志消息中的控制字符。 这可以允许连接到你的服务器的远程客户端向你的终端发送邪恶的控制代码。</p>
<div class="versionchanged">
<p><span class="versionmodified changed">在 3.12 版本发生变更: </span>控制字符会在 stderr 日志中被擦除。</p>
</div>
</section>
</section>


            <div class="clearer"></div>
          </div>
      </div>
      <div class="clearer"></div>
    </div>
  </body>
</html>